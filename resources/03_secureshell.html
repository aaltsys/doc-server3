<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Remote Secure Shell Sessions &mdash; AAltsys Server 3.0 Technical 3.0 documentation</title>
    
    <link rel="stylesheet" href="_static/aaltsys.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="AAltsys Server 3.0 Technical 3.0 documentation" href="index.html" />
    <link rel="next" title="Server Network Setup" href="04_network.html" />
    <link rel="prev" title="Mounting Network File Systems" href="02_filesharing.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="04_network.html" title="Server Network Setup"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="02_filesharing.html" title="Mounting Network File Systems"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">AAltsys Server 3.0 Technical 3.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Remote Secure Shell Sessions</a><ul>
<li><a class="reference internal" href="#command-line-usage">Command line usage</a></li>
<li><a class="reference internal" href="#gnome-terminal">Gnome terminal</a></li>
<li><a class="reference internal" href="#redirecting-ssh-to-putty">Redirecting SSH to PuTTY</a></li>
<li><a class="reference internal" href="#fixing-changed-ssh-keys">Fixing Changed SSH Keys</a></li>
<li><a class="reference internal" href="#fixing-x11-forwarding-zentyal">Fixing X11 Forwarding Zentyal</a><ul>
<li><a class="reference internal" href="#missing-xauth">Missing <strong class="program">xauth</strong></a></li>
<li><a class="reference internal" href="#ssh-uses-ipv4-and-not-ipv6">ssh uses IPV4 and not IPV6</a></li>
<li><a class="reference internal" href="#x11-forwarding-turned-off">X11 Forwarding turned off</a></li>
</ul>
</li>
<li><a class="reference internal" href="#accessing-servers-over-ssh">Accessing Servers over SSH</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="02_filesharing.html"
                        title="previous chapter">Mounting Network File Systems</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="04_network.html"
                        title="next chapter">Server Network Setup</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/03_secureshell.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="remote-secure-shell-sessions">
<h1>Remote Secure Shell Sessions<a class="headerlink" href="#remote-secure-shell-sessions" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>This article includes proprietary information about AAltSys logins. Please
generalize this material before release:</p>
<div class="last highlight-python"><div class="highlight"><pre>Identify username _____________________________________,
registration __________________________________________,
LTSP server IP ________________________________________.
</pre></div>
</div>
</div>
<div class="section" id="command-line-usage">
<h2>Command line usage<a class="headerlink" href="#command-line-usage" title="Permalink to this headline">¶</a></h2>
<p>Basic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ssh</span> <span class="o">-</span><span class="n">l</span> <span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="p">[</span><span class="n">registration</span><span class="p">]</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">aaltsys</span><span class="o">.</span><span class="n">net</span>
</pre></div>
</div>
<p>NX Port forwarding of LTSP server:</p>
<div class="highlight-python"><div class="highlight"><pre>ssh -L8889:ltspserver:8888 -l [username] [registration].servers.aaltsys.net
</pre></div>
</div>
</div>
<div class="section" id="gnome-terminal">
<h2>Gnome terminal<a class="headerlink" href="#gnome-terminal" title="Permalink to this headline">¶</a></h2>
<p>X-11 Forwarding with gnome-terminal (default IP for ltspserver is 10.4.0.2):</p>
<div class="highlight-python"><div class="highlight"><pre>gnome-terminal -x ssh -L8889:ltspserver:8888 -l [username] [registration].servers.aaltsys.net
</pre></div>
</div>
</div>
<div class="section" id="redirecting-ssh-to-putty">
<h2>Redirecting SSH to PuTTY<a class="headerlink" href="#redirecting-ssh-to-putty" title="Permalink to this headline">¶</a></h2>
<p>PuTTY is an open-source cross-platform client for secure connections with
remote hosts. It is available on Windows, Linux, and Mac, and it is the
preferred client on Windows. PuTTY adds power to interactive sessions. For
example, a user can add a port forwarding rule within a running terminal
session.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Install and configure PuTTY on a Debian KDE system using instructions from
<a class="reference external" href="http://servers.aaltsys.info/resources/06_ssh_samba.html#redirecting-ssh-to-putty">http://servers.aaltsys.info/resources/06_ssh_samba.html#redirecting-ssh-to-putty</a>.</p>
</div>
</div>
<div class="section" id="fixing-changed-ssh-keys">
<h2>Fixing Changed SSH Keys<a class="headerlink" href="#fixing-changed-ssh-keys" title="Permalink to this headline">¶</a></h2>
<p>When using <strong class="command">ssh</strong> from a terminal icon or weblink, the session may
abort when starting. The most likely cause for this is a change to the ssh
key. To address the problem for a terminal icon, open a terminal shell prompt:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ssh</span> <span class="p">[</span><span class="n">registration</span><span class="p">]</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">aaltsys</span><span class="o">.</span><span class="n">net</span>
</pre></div>
</div>
<p>Address this problem for a weblink:</p>
<div class="highlight-python"><div class="highlight"><pre>ssh://[registration].servers.aaltsys.net/
</pre></div>
</div>
<p>The line number in your <code class="file docutils literal"><span class="pre">~/.ssh/known_hosts</span></code> file which is wrong will be
displayed. Delete this line with the command:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo sed -i c\[linenumber] ~/.ssh/known_hosts
</pre></div>
</div>
</div>
<div class="section" id="fixing-x11-forwarding-zentyal">
<h2>Fixing X11 Forwarding Zentyal<a class="headerlink" href="#fixing-x11-forwarding-zentyal" title="Permalink to this headline">¶</a></h2>
<p>Zentyal may disable X11 forwarding, which prevents <strong class="command">dosemu</strong> sessions
from working, among other things.</p>
<div class="section" id="missing-xauth">
<h3>Missing <strong class="program">xauth</strong><a class="headerlink" href="#missing-xauth" title="Permalink to this headline">¶</a></h3>
<p>On Zentyal 2.0 and below, the <strong class="program">xauth</strong> is missing. Install it with:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo apt-get install xauth
</pre></div>
</div>
</div>
<div class="section" id="ssh-uses-ipv4-and-not-ipv6">
<h3>ssh uses IPV4 and not IPV6<a class="headerlink" href="#ssh-uses-ipv4-and-not-ipv6" title="Permalink to this headline">¶</a></h3>
<p>On Zentyal 3.0+, Localhost may have an IPV6 address configured, preventing X11
forwarding by localhost over IPV4. The following commands (on the remote server,
of course) prevent <strong class="program">ssh</strong> from attempting IPV6:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo sed -ie &quot;/\/usr\/sbin\/sshd -D/c\exec \/usr\/sbin\/sshd -D -4&quot; /etc/init/ssh.conf
sudo service ssh reload
</pre></div>
</div>
<p>If <code class="file docutils literal"><span class="pre">/etc/hosts</span></code> configures <code class="docutils literal"><span class="pre">localhost</span></code> under <code class="docutils literal"><span class="pre">ip6</span></code>, then the following
command might fix this configuration:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo sed -ie &quot;/localhost ip6/c\::1\tip6-localhost\tip6-loopback&quot; /etc/hosts
</pre></div>
</div>
<p>Check to see that the <code class="docutils literal"><span class="pre">127.0.0.1</span></code> line includes <code class="docutils literal"><span class="pre">localhost</span></code> afterwards.</p>
</div>
<div class="section" id="x11-forwarding-turned-off">
<h3>X11 Forwarding turned off<a class="headerlink" href="#x11-forwarding-turned-off" title="Permalink to this headline">¶</a></h3>
<p>File <code class="file docutils literal"><span class="pre">/etc/ssh/sshd_config</span></code> should have 3 option lines for X11 Forwarding
as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>X11Forwarding yes
X11DisplayOffset 10
X11UseLocalhost yes
</pre></div>
</div>
<p>Correct any problems here by editing the configuration files and then reloading
sshd:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo nano /etc/ssh/sshd_config
sudo service ssh reload
</pre></div>
</div>
</div>
</div>
<div class="section" id="accessing-servers-over-ssh">
<h2>Accessing Servers over SSH<a class="headerlink" href="#accessing-servers-over-ssh" title="Permalink to this headline">¶</a></h2>
<p>In this example, an administrator wishes to connect to a remote Windows session
running as a virtual machine on a Linux server. The Linux server is accessed at
the domain name <code class="docutils literal"><span class="pre">https://remoteserver.support.aaltsys.com</span></code>. Both the Windows
session and the Linux server authenticate <code class="docutils literal"><span class="pre">username</span></code> and <code class="docutils literal"><span class="pre">password</span></code> for
logins.</p>
<p>First display a terminal window on the local machine, then ssh to the remote
server:</p>
<div class="highlight-python"><div class="highlight"><pre>xdg-open ssh://username@remoteserver.support.aaltsys.com
</pre></div>
</div>
<p>Now explore the remote environment to identify Windows RDP servers. Recommended
commands are:</p>
<div class="highlight-python"><div class="highlight"><pre>smbclient -L NETBIOSNAME
smbtree
</pre></div>
</div>
<p>These commands identify the virtualized windows session as <code class="docutils literal"><span class="pre">XPUNLIMITED</span></code>. Now
find the IP for this machine using either of the commands:</p>
<div class="highlight-python"><div class="highlight"><pre>net lookup XPUNLIMITED
nmblookup XPUNLIMITED
</pre></div>
</div>
<p>Suppose the remote Windows terminal server <strong>XPUNLIMITED</strong> uses IP
<strong>192.168.2.243</strong> in its local network. Display the PuTTY menu with
<code class="kbd docutils literal"><span class="pre">&lt;Ctrl-RightClick&gt;</span></code>, and choose <em class="menuselection">Change Settings...</em>.
Then select Category: <em class="menuselection">Connection &gt; SSH &gt; Tunnels</em> and enter:</p>
<div class="highlight-python"><div class="highlight"><pre>Source port -- 3389
Destination -- 192.168.2.243:3389
Click -- Add
Click -- Apply
</pre></div>
</div>
<p>Finally, open the KRDC Remote Desktop client on the KDE Desktop, and connect
to: <em class="guilabel">rdp</em> :kbd:<code class="docutils literal"><span class="pre">localhost</span></code>. A remote Windows RDP session will
display as if it were local, being redirected to you over SSH.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="04_network.html" title="Server Network Setup"
             >next</a></li>
        <li class="right" >
          <a href="02_filesharing.html" title="Mounting Network File Systems"
             >previous</a> |</li>
        <li><a href="index.html">AAltsys Server 3.0 Technical 3.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012, Gerald Lovel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b1.
    </div>
  </body>
</html>